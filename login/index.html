<!DOCTYPE html>
<html>
   <head>
      <style>
         html[data-theme="dark"] {
            background-color: #1a1a1a;
         }
         html[data-theme="dark"] body {
            background-color: #1a1a1a;
         }
      </style>
      <title>Login - Publiq Forum</title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <link rel="stylesheet" href="../css/style.css">
      <link rel="icon" type="image/x-icon" href="../media/logo.png">
   </head>
   <body>
      <header id="header">
         <div class="innertube">
            <a href="../" class="logo-link">
               <img src="../media/logo.png" alt="Publiq Forum Logo" class="logo">
               <h1>Publiq Forum</h1>
            </a>
         </div>
      </header>
      <div id="wrapper">
         <nav id="nav">
            <div class="innertube">
               <h3>Post</h3>
               <ul>
                  <li><a href="../post/">See posts</a></li>
                  <li><a href="../post/create/">Create posts</a></li>
               </ul>
               <h3>User</h3>
               <ul>
                  <li><a href="../user/settings/">Settings</a></li>
                  <li><a href="../user/[username]/">See profile</a></li>
               </ul>
               <h3>Login</h3>
               <ul>
                  <li><a href="../login/">Login</a></li>
                  <li><a href="../register/">Register</a></li>
               </ul>
            </div>
         </nav>
         <main>

            <!-- PAGE CONTENT GOES HERE -->
            <section>
               <h2>Login</h2>
               <p>Enter your email and password to sign in.</p>
               <form id="login-form" style="max-width:420px;margin-top:1rem;">
                   <label>Email</label>
                   <input type="email" id="email" required style="width:100%;padding:0.5rem;margin:0.5rem 0;border-radius:6px;border:1px solid var(--border-color);">
                   <label>Password</label>
                   <input type="password" id="password" required style="width:100%;padding:0.5rem;margin:0.5rem 0;border-radius:6px;border:1px solid var(--border-color);">
                   <button type="submit" id="login-btn" class="theme-btn" style="margin-top:0.5rem;">Login</button>
               </form>
               <p style="margin-top:1rem;">Don't have an account? <a href="../register/">Register</a></p>
            </section>
            <!-- PAGE CONTENT GOES HERE -->

         </main>
      </div>
      <footer id="footer">
         <div class="innertube">
            <div class="footer-content">
               <div class="footer-section">
                  <h4>Forum</h4>
                  <ul>
                     <li><a href="../post/">Browse Posts</a></li>
                     <li><a href="../post/create/">Create Post</a></li>
                     <li><a href="../user/settings/">Settings</a></li>
                  </ul>
               </div>
               <div class="footer-section">
                  <h4>Account</h4>
                  <ul>
                     <li><a href="../login/">Login</a></li>
                     <li><a href="../register/">Register</a></li>
                     <li><a href="../user/[username]/">Profile</a></li>
                  </ul>
               </div>
               <div class="footer-section">
                  <h4>Resources</h4>
                  <ul>
                     <li><a href="../terms/">Terms</a></li>
                     <li><a href="../privacy/">Privacy</a></li>
                  </ul>
               </div>
               <div class="footer-section">
                  <h4>Contact</h4>
                  <ul>
                     <li><a href="../contact/">Support</a></li>
                  </ul>
               </div>
            </div>
            <div class="footer-bottom">
               <p><span id="year"></span> Publiq Forum.</p>
            </div>
         </div>
      </footer>
      <script src="../js/config.js"></script>
      <script src="../js/main.js"></script>
         <script>
            // handle form
            document.addEventListener('DOMContentLoaded', function(){
               const form = document.getElementById('login-form');
               form.addEventListener('submit', async function(e){
                  e.preventDefault();
                  const email = document.getElementById('email').value;
                  const password = document.getElementById('password').value;
                  try {
                     const res = await fetch(window.AUTH_API_BASE + '/login', {
                        method: 'POST', headers: {'Content-Type':'application/json'},
                        body: JSON.stringify({ email, password })
                     });
                     const data = await res.json();
                     if (data.token) {
                        localStorage.setItem('auth_token', data.token);
                        window.location.href = '/';
                     } else {
                        alert(data.error || 'Login failed');
                     }
                  } catch (err) { alert('Request failed'); }
               });
            });
         </script>
      	<script src="../js/settings.js"></script>
   </body>
</html>